## 2. Интерпретатор CPython

На этапе импорта интерпретатор производит синтаксический анализ исходного кода сверху вниз и компилирует исполняемый байт-код. На этом этапе обнаруживаются синтаксические ошибки. Этот этап пропускается, если в локальном кеше `__pycache__` найден актуальный `.pyc`-файл с готовым байт-кодом.

Во время компиляции выполняется весь код, находящийся на верхнем уровне программы, а также весь код, находящийся на верхних уровнях импортируемых модулей. При этом происходит связывание имён. Функции компилируются, но их код не выполняется. Код классов, напротив, выполняется полностью, включая вложенные классы: определяются атрибуты и методы, строится объект класса.

Во время компиляции интерпретатор формирует объект кода (*code object*), который содержит байт-код, константы, имена и другую служебную информацию. Эти объекты затем передаются виртуальной машине Python для выполнения.

Код на верхнем уровне модуля исполняется немедленно при импорте. Поэтому любые побочные эффекты, такие как вывод на экран или изменение глобального состояния, происходят сразу при подключении модуля.

Для разделения исполняемого кода и импортируемой логики принято использовать конструкцию:

```python
if __name__ == "__main__":
    main()
```

Это позволяет выполнять определённые действия только при запуске файла напрямую, а не при его импорте как модуля.